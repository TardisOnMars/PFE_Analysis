---
title: "PFE : Analyse des données questionnaire"
output: html_notebook
---


```{r}
source("LoadData.R", encoding = "UTF-8")
source("Stats_functions.R")
source("PLS_functions.R")
```

```{r}
hist(aesthetic_df$aesthetic, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Esthétique", xlab="Score Esthétique")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(aesthetic_df$aesthetic)$p.value, 3)), line = -2)
hist(aesthetic_df$challenge, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Défi", xlab="Score Défi")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(aesthetic_df$challenge)$p.value, 3)), line = -2)
hist(aesthetic_df$narrative, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Narration", xlab="Score Narration")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(aesthetic_df$narrative)$p.value, 3)), line = -2)
hist(aesthetic_df$objectives, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Objectifs", xlab="Score Objectifs")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(aesthetic_df$objectives)$p.value, 3)), line = -2)
hist(aesthetic_df$social, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Social", xlab="Score Social")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(aesthetic_df$social)$p.value, 3)), line = -2)
```

```{r}
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
scenario_bp("sense_of_control")
scenario_bp("loss_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement", y_range=c(0, 7))
```

```{r}
order_bp("challenge_skill_balance")
order_bp("action_awareness")
order_bp("clear_goals")
order_bp("unambiguous_feedback")
order_bp("concentration")
order_bp("sense_of_control")
order_bp("loss_self_consciousness")
order_bp("time_transformation")
order_bp("autotelic_experience")
order_bp("engagement", y_range=c(0, 7))
```

```{r}
scenario_order_bp("challenge_skill_balance", order = 1)
scenario_order_bp("action_awareness", order = 1)
scenario_order_bp("clear_goals", order = 1)
scenario_order_bp("unambiguous_feedback", order = 1)
scenario_order_bp("concentration", order = 1)
scenario_order_bp("sense_of_control", order = 1)
scenario_order_bp("loss_self_consciousness", order = 1)
scenario_order_bp("time_transformation", order = 1)
scenario_order_bp("autotelic_experience", order = 1)
scenario_order_bp("engagement", y_range=c(0, 7), order = 1)
```

```{r}
scenario_order_bp("challenge_skill_balance", order = 2)
scenario_order_bp("action_awareness", order = 2)
scenario_order_bp("clear_goals", order = 2)
scenario_order_bp("unambiguous_feedback", order = 2)
scenario_order_bp("concentration", order = 2)
scenario_order_bp("sense_of_control", order = 2)
scenario_order_bp("loss_self_consciousness", order = 2)
scenario_order_bp("time_transformation", order = 2)
scenario_order_bp("autotelic_experience", order = 2)
scenario_order_bp("engagement", y_range=c(0, 7), order = 2)
```

```{r}
scenario_order_bp("challenge_skill_balance", order = 3)
scenario_order_bp("action_awareness", order = 3)
scenario_order_bp("clear_goals", order = 3)
scenario_order_bp("unambiguous_feedback", order = 3)
scenario_order_bp("concentration", order = 3)
scenario_order_bp("sense_of_control", order = 3)
scenario_order_bp("loss_self_consciousness", order = 3)
scenario_order_bp("time_transformation", order = 3)
scenario_order_bp("autotelic_experience", order = 3)
scenario_order_bp("engagement", y_range=c(0, 7), order = 3)
```

```{r}
order_scenario_bp("challenge_skill_balance", scenario = "aesthetic")
order_scenario_bp("action_awareness", scenario = "aesthetic")
order_scenario_bp("clear_goals", scenario = "aesthetic")
order_scenario_bp("unambiguous_feedback", scenario = "aesthetic")
order_scenario_bp("concentration", scenario = "aesthetic")
order_scenario_bp("sense_of_control", scenario = "aesthetic")
order_scenario_bp("loss_self_consciousness", scenario = "aesthetic")
order_scenario_bp("time_transformation", scenario = "aesthetic")
order_scenario_bp("autotelic_experience", scenario = "aesthetic")
order_scenario_bp("engagement", y_range=c(0, 7), scenario = "aesthetic")
```

```{r}
order_scenario_bp("challenge_skill_balance", scenario = "narrative")
order_scenario_bp("action_awareness", scenario = "narrative")
order_scenario_bp("clear_goals", scenario = "narrative")
order_scenario_bp("unambiguous_feedback", scenario = "narrative")
order_scenario_bp("concentration", scenario = "narrative")
order_scenario_bp("sense_of_control", scenario = "narrative")
order_scenario_bp("loss_self_consciousness", scenario = "narrative")
order_scenario_bp("time_transformation", scenario = "narrative")
order_scenario_bp("autotelic_experience", scenario = "narrative")
order_scenario_bp("engagement", y_range=c(0, 7), scenario = "narrative")
```

```{r}
order_scenario_bp("challenge_skill_balance", scenario = "objectives")
order_scenario_bp("action_awareness", scenario = "objectives")
order_scenario_bp("clear_goals", scenario = "objectives")
order_scenario_bp("unambiguous_feedback", scenario = "objectives")
order_scenario_bp("concentration", scenario = "objectives")
order_scenario_bp("sense_of_control", scenario = "objectives")
order_scenario_bp("loss_self_consciousness", scenario = "objectives")
order_scenario_bp("time_transformation", scenario = "objectives")
order_scenario_bp("autotelic_experience", scenario = "objectives")
order_scenario_bp("engagement", y_range=c(0, 7), scenario = "objectives")
```
```{r}
pls_analysis(aesthetic_df, narrative_df, objectives_df)
```
```{r}
pls_analysis(aesthetic_first, narrative_first, objectives_first, color_lim = NULL)
```

```{r}
pls_analysis(aesthetic_second, narrative_second, objectives_second, color_lim = NULL)
```

```{r}
pls_analysis(aesthetic_third, narrative_third, objectives_third, color_lim = NULL)
```
```{r}
pls_analysis(bind_rows(aesthetic_second, aesthetic_third),
             bind_rows(narrative_second, narrative_third),
             bind_rows(objectives_second, objectives_third))
```