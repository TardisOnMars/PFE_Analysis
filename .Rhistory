narrative_dfs = plspm_traits_dfs_4(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs_4(traits_join_DFS_Objective)
}
par(mfrow = c(1,3))
plot_plspm_traits_dfs(aesthetic_dfs$path_coefs, aesthetic_dfs$p_values, title = "Aesthetic scenario")
plot_plspm_traits_dfs(narrative_dfs$path_coefs, narrative_dfs$p_values, title = "Narrative scenario")
plot_plspm_traits_dfs(objective_dfs$path_coefs, objective_dfs$p_values, title = "Objectives scenario")
mtext("Significative level = 0.05", line=-6, outer = TRUE)
par(mfrow=c(1,3))
plot_plspm_traits_dfs(aesthetic_dfs$path_coefs, aesthetic_dfs$p_values, significative_level = 0.1 ,title = "Aesthetic scenario")
plot_plspm_traits_dfs(narrative_dfs$path_coefs, narrative_dfs$p_values, significative_level = 0.1, title = "Narrative scenario")
plot_plspm_traits_dfs(objective_dfs$path_coefs, objective_dfs$p_values, significative_level = 0.1, title = "Objectives scenario")
mtext("Significative level = 0.10", line = -6, outer = TRUE)
}
pls_analysis(traits_join_DFS_Aesthetic, traits_join_DFS_Narrative, traits_join_DFS_Objective)
source("PLS_functions.R")
pls_analysis(traits_join_DFS_Aesthetic, traits_join_DFS_Narrative, traits_join_DFS_Objective)
source("PLS_functions.R")
pls_analysis(traits_join_DFS_Aesthetic, traits_join_DFS_Narrative, traits_join_DFS_Objective)
scenario_bp = function(dimension = ""){
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective[dimension],
Aesthetic=traits_join_DFS_Aesthetic[dimension],
Narrative=traits_join_DFS_Narrative[dimension]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Challenge-Skill Balance", line=1)
sumaov <- summary.aov(aov(dimension ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("concentration")
scenario_bp = function(dimension = ""){
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective[dimension],
Aesthetic=traits_join_DFS_Aesthetic[dimension],
Narrative=traits_join_DFS_Narrative[dimension]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(dimension ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("concentration")
scenario_bp("challenge_skill_balance")
dimension = "concentration"
traits_join_DFS_Objective[dimension]
traits_join_DFS_Objective$concentration
scenario_bp = function(dimension = ""){
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(dimension ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("challenge_skill_balance")
scenario_bp = function(dimension = ""){
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(concentration ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("concentration")
scenario_bp = function(dimension = ""){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(concentration ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("concentration")
scenario_bp("concentration")
scenario_bp = function(dimension = ""){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(traits_join_DFS[[dimension]] ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("concentration")
#### Basic Stats
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective$challenge_skill_balance,
Aesthetic=traits_join_DFS_Aesthetic$challenge_skill_balance,
Narrative=traits_join_DFS_Narrative$challenge_skill_balance), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Challenge-Skill Balance", line=1)
sumaov <- summary.aov(aov(challenge_skill_balance ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$action_awareness,
Aesthetic=traits_join_DFS_Aesthetic$action_awareness,
Narrative=traits_join_DFS_Narrative$action_awareness), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Action Awareness", line=1)
sumaov <- summary.aov(aov(action_awareness ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$clear_goals,
Aesthetic=traits_join_DFS_Aesthetic$clear_goals,
Narrative=traits_join_DFS_Narrative$clear_goals), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Clear Goals", line=1)
sumaov <- summary.aov(aov(clear_goals ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$unambiguous_feedback,
Aesthetic=traits_join_DFS_Aesthetic$unambiguous_feedback,
Narrative=traits_join_DFS_Narrative$unambiguous_feedback), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Unambiguous Feedback", line=1)
sumaov <- summary.aov(aov(unambiguous_feedback ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$concentration,
Aesthetic=traits_join_DFS_Aesthetic$concentration,
Narrative=traits_join_DFS_Narrative$concentration), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Concentration", line=1)
sumaov <- summary.aov(aov(concentration ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
par(mfrow=c(1,5))
boxplot(data.frame(Objectives=traits_join_DFS_Objective$sense_of_control,
Aesthetic=traits_join_DFS_Aesthetic$sense_of_control,
Narrative=traits_join_DFS_Narrative$sense_of_control), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Sense of Control", line=1)
sumaov <- summary.aov(aov(sense_of_control ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$loss_self_consciousness,
Aesthetic=traits_join_DFS_Aesthetic$loss_self_consciousness,
Narrative=traits_join_DFS_Narrative$loss_self_consciousness), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Loss of Self Consciousness", line=1)
sumaov <- summary.aov(aov(loss_self_consciousness ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$time_transformation,
Aesthetic=traits_join_DFS_Aesthetic$time_transformation,
Narrative=traits_join_DFS_Narrative$time_transformation), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Time Transformation", line=1)
sumaov <- summary.aov(aov(time_transformation ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$autotelic_experience,
Aesthetic=traits_join_DFS_Aesthetic$autotelic_experience,
Narrative=traits_join_DFS_Narrative$autotelic_experience), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Autotelic Experience", line=1)
sumaov <- summary.aov(aov(autotelic_experience ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
boxplot(data.frame(Objectives=traits_join_DFS_Objective$engagement,
Aesthetic=traits_join_DFS_Aesthetic$engagement,
Narrative=traits_join_DFS_Narrative$engagement), ylab = "score", ylim=c(0,7), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext("Engagement", line=1)
sumaov <- summary.aov(aov(engagement ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
scenario_bp("challenge_skill_balance")
source("LoadData.R",encoding="utf-8")
scenario_bp = function(dimension = ""){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(traits_join_DFS[[dimension]] ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
scenario_bp("sense_of_control")
scenario_bp("loss_of_self_consciousness")
scenario_bp("time-transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement")
par(mfrow=c(1,5))
hist(traits_join_DFS_Aesthetic$aesthetic, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Esthétique", xlab="Score Esthétique")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$aesthetic)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$challenge, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Défi", xlab="Score Défi")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$challenge)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$narrative, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Narration", xlab="Score Narration")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$narrative)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$objectives, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Objectifs", xlab="Score Objectifs")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$objectives)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$social, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Social", xlab="Score Social")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$social)$p.value, 3)))
source("LoadData.R",encoding="utf-8")
scenario_bp = function(dimension = ""){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(traits_join_DFS[[dimension]] ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
par(mfrow=c(1,5))
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
par(mfrow=c(1,5))
scenario_bp("sense_of_control")
scenario_bp("loss_of_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement")
par(mfrow=c(1,5))
hist(traits_join_DFS_Aesthetic$aesthetic, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Esthétique", xlab="Score Esthétique")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$aesthetic)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$challenge, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Défi", xlab="Score Défi")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$challenge)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$narrative, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Narration", xlab="Score Narration")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$narrative)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$objectives, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Objectifs", xlab="Score Objectifs")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$objectives)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$social, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Social", xlab="Score Social")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$social)$p.value, 3)))
source("LoadData.R",encoding="utf-8")
scenario_bp = function(dimension = ""){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=c(0,28), col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(traits_join_DFS[[dimension]] ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
par(mfrow=c(1,5))
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
par(mfrow=c(1,5))
scenario_bp("sense_of_control")
scenario_bp("loss_of_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement")
par(mfrow=c(1,5))
hist(traits_join_DFS_Aesthetic$aesthetic, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Esthétique", xlab="Score Esthétique")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$aesthetic)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$challenge, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Défi", xlab="Score Défi")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$challenge)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$narrative, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Narration", xlab="Score Narration")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$narrative)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$objectives, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Objectifs", xlab="Score Objectifs")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$objectives)$p.value, 3)))
hist(traits_join_DFS_Aesthetic$social, xlim=c(0, 100), ylim=c(0, 15), main="Répartition du score Social", xlab="Score Social")
mtext(paste("Shapiro-Wilk normality test", round(shapiro.test(traits_join_DFS_Aesthetic$social)$p.value, 3)))
View(traits_join_DFS)
par(mfrow=c(1,5))
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
par(mfrow=c(1,5))
scenario_bp("sense_of_control")
scenario_bp("loss_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement")
par(mfrow=c(1,5))
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
par(mfrow=c(1,5))
scenario_bp("sense_of_control")
scenario_bp("loss_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement", y_range=c(0, 7))
source("LoadData.R",encoding="utf-8")
scenario_bp = function(dimension = "", y_range=c(0,28)){
boxplot(data.frame(Objectives=traits_join_DFS_Objective[[dimension]],
Aesthetic=traits_join_DFS_Aesthetic[[dimension]],
Narrative=traits_join_DFS_Narrative[[dimension]]), ylab = "score", ylim=y_range, col=c("darkorchid1", "cadetblue1", "darkolivegreen1"))
mtext(dimension, line=1)
sumaov <- summary.aov(aov(traits_join_DFS[[dimension]] ~ qu.avez.vous.vu.lors.de.l.experience..,data=traits_join_DFS))
mtext(paste("P-Value of ANOVA Analysis", round(sumaov[[1]][[1,"Pr(>F)"]], digits=3)), side=1, line=3)
}
par(mfrow=c(1,5))
scenario_bp("challenge_skill_balance")
scenario_bp("action_awareness")
scenario_bp("clear_goals")
scenario_bp("unambiguous_feedback")
scenario_bp("concentration")
par(mfrow=c(1,5))
scenario_bp("sense_of_control")
scenario_bp("loss_self_consciousness")
scenario_bp("time_transformation")
scenario_bp("autotelic_experience")
scenario_bp("engagement", y_range=c(0, 7))
plspm_traits_dfs_5 = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = c(87, 88, 89, 94)
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = rep("A", 4)
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model_4.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:10]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
pls_analysis(traits_join_DFS_Aesthetic, traits_join_DFS_Narrative, traits_join_DFS_Objective, type=5)
library(plspm)
library(corrplot)
library(RColorBrewer)
source("LoadData.R",encoding="utf-8")
plspm_traits_dfs = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = 86:94
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = rep("A", 9)
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:15]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
plspm_traits_dfs_2 = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = list(86:94)
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = "A"
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model_2.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:7]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
plspm_traits_dfs_3 = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = c(87, 89, 90, 92, 93, 94)
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = rep("A", 6)
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model_3.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:12]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
plspm_traits_dfs_4 = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = list(c(87, 89, 90, 92, 93, 94))
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = "A"
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model_2.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:7]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
plspm_traits_dfs_5 = function(traits_join_dfs_df){
traits_blocks = 36:40
dfs_blocks = c(87, 88, 89, 94)
presence_blocks = 95
traits_dfs_blocks = append(traits_blocks, dfs_blocks)
traits_dfs_blocks = as.list(append(traits_dfs_blocks, presence_blocks))
traits_modes = rep("A", 5)
dfs_modes = rep("A", 4)
presence_modes = "A"
traits_dfs_modes = append(traits_modes, dfs_modes)
traits_dfs_modes = append(traits_dfs_modes, presence_modes)
traits_dfs_path = read.csv("path_inner_model_4.csv", header=TRUE, sep=";", row.names = 1)
traits_dfs_path = as.matrix(traits_dfs_path)
rownames(traits_dfs_path) = make.names(rownames(traits_dfs_path))
colnames(traits_dfs_path) = rownames(traits_dfs_path)
traits_dfs_pls = plspm(traits_join_dfs_df, traits_dfs_path, traits_dfs_blocks, scaled = FALSE )
input_vars = colnames(traits_dfs_path)[1:5]
output_vars = colnames(traits_dfs_path)[6:10]
path_coefs = traits_dfs_pls$path_coefs[output_vars, input_vars]
p_values = matrix(nrow=length(input_vars), ncol=length(output_vars))
rownames(p_values) = input_vars
colnames(p_values) = output_vars
p_values = data.frame(p_values)
for(var in output_vars){
p_values[,var] = traits_dfs_pls$inner_model[[var]][2:(length(input_vars)+1),4]
}
p_values = t(p_values)
results <- list("path_coefs" = path_coefs, "p_values" = p_values, "traits_dfs_pls" = traits_dfs_pls)
return(results)
}
plot_plspm_traits_dfs = function(path_coefs, p_values, significative_level = 0.05, title = "")
{
corrplot(path_coefs, title=title,
sig.level = significative_level, p.mat = p_values,
is.corr = FALSE, cl.lim=c(-1.0, 1.0), col=brewer.pal(n=8, name="PuOr"),
insig = "blank",  mar=c(0,0,2,0))
}
pls_analysis = function(aesthetic_df, narrative_df, objectives_df, type=1){
if(type==1){
aesthetic_dfs = plspm_traits_dfs(traits_join_DFS_Aesthetic)
narrative_dfs = plspm_traits_dfs(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs(traits_join_DFS_Objective)
}else if(type==2){
aesthetic_dfs = plspm_traits_dfs_2(traits_join_DFS_Aesthetic)
narrative_dfs = plspm_traits_dfs_2(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs_2(traits_join_DFS_Objective)
}else if(type==3){
aesthetic_dfs = plspm_traits_dfs_3(traits_join_DFS_Aesthetic)
narrative_dfs = plspm_traits_dfs_3(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs_3(traits_join_DFS_Objective)
}else if(type==4){
aesthetic_dfs = plspm_traits_dfs_4(traits_join_DFS_Aesthetic)
narrative_dfs = plspm_traits_dfs_4(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs_4(traits_join_DFS_Objective)
}else if(type==5){
aesthetic_dfs = plspm_traits_dfs_5(traits_join_DFS_Aesthetic)
narrative_dfs = plspm_traits_dfs_5(traits_join_DFS_Narrative)
objective_dfs = plspm_traits_dfs_5(traits_join_DFS_Objective)
}
par(mfrow = c(1,3))
plot_plspm_traits_dfs(aesthetic_dfs$path_coefs, aesthetic_dfs$p_values, title = "Aesthetic scenario")
plot_plspm_traits_dfs(narrative_dfs$path_coefs, narrative_dfs$p_values, title = "Narrative scenario")
plot_plspm_traits_dfs(objective_dfs$path_coefs, objective_dfs$p_values, title = "Objectives scenario")
mtext("Significative level = 0.05", line=-6, outer = TRUE)
par(mfrow=c(1,3))
plot_plspm_traits_dfs(aesthetic_dfs$path_coefs, aesthetic_dfs$p_values, significative_level = 0.1 ,title = "Aesthetic scenario")
plot_plspm_traits_dfs(narrative_dfs$path_coefs, narrative_dfs$p_values, significative_level = 0.1, title = "Narrative scenario")
plot_plspm_traits_dfs(objective_dfs$path_coefs, objective_dfs$p_values, significative_level = 0.1, title = "Objectives scenario")
mtext("Significative level = 0.10", line = -6, outer = TRUE)
}
pls_analysis(traits_join_DFS_Aesthetic, traits_join_DFS_Narrative, traits_join_DFS_Objective, type=5)
